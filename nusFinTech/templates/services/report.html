{% extends "base.html" %}
    {% block body_block %}
        <canvas class="my-4 w-100 chartjs-render-monitor" id="myChart" width="1076" height="454"
            style="display: block; width: 1076px; height: 454px;"></canvas>

        <div class="container border border-dark rounded">
            <div class="row justify-content-md-center">
                <div class="col col-lg-2"><small>Balance</small></div>
                <div class="col col-lg-2"><small>Profit</small></div>
            </div>
            <div class="row justify-content-md-center">
                {% with final_trxn=ledger|last %}
                <div class="col col-lg-2"><h2>{{ final_trxn.balance|floatformat:3 }}</h2></div>
                <div class="col col-lg-2">
                {% if final_trxn.profit > 0 %}
                    <h2 class="text-success">{{ final_trxn.profit|floatformat:3 }}</h2>
                {% else %}
                    <h2 class="text-danger">{{ final_trxn.profit|floatformat:3 }}</h2>
                {% endif %}
                </div>
                {% endwith%}
            </div>

        </div>
        <h2>Daily Accumulation</h2>
        <div class="float-left w-50">
        {% for trxn in ledger reversed %}
        <div class="container border-bottom border-dark">
            <div class="row justify-content-md-left">
                <div class="col col-lg-2 font-weight-bold">Profit</div>
                {% if trxn.profit > 0 %}
                <div class="col col-lg-2 font-weight-bold text-success">
                {% else %}
                <div class="col col-lg-2 font-weight-bold text-danger">
                {% endif %}
                    {{trxn.profit|floatformat:3}}
                </div>
            </div>
            <div class="row justify-content-md-left">
                <div class="col col-lg-2 font-weight-light">{{trxn.transactionDate|date:"d/m/Y"}}</div>
                <div class="col col-lg-2 font-weight-light">{{trxn.balance|floatformat:3}}</div>    
            </div>
        </div>
        {% endfor %}
        </div>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.9.0/feather.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
        
        <script>
            /* globals Chart:false, feather:false */

            (function () {
                'use strict'

                feather.replace()

                // Graphs
                var ctx = document.getElementById('myChart')
                // eslint-disable-next-line no-unused-vars
                var myChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: [
                        {% for trxn in ledger %}
                            '{{trxn.transactionDate|date:"d/m/Y"}}',
                        {% endfor %}
                        ],
                        datasets: [{
                            data: [
                            {% for trxn in ledger %}
                            {{trxn.balance|floatformat:3}},
                            {% endfor %}
                            ],
                            lineTension: 0,
                            backgroundColor: 'transparent',
                            borderColor: '#007bff',
                            borderWidth: 4,
                            pointBackgroundColor: '#007bff'
                        }]
                    },
                    options: {
                        scales: {
                            yAxes: [{
                                ticks: {
                                    beginAtZero: false
                                }
                            }]
                        },
                        legend: {
                            display: false
                        }
                    }
                })
            }())

        </script>
    {% endblock%}